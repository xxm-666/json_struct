# JSONPath Comprehensive Test Suite

## 概述

`test_jsonpath_comprehensive.cpp` 是一个全面的JSONPath功能测试套件，用于测试json_engine中JSONPath实现的各个方面。该测试套件包含106个测试用例，涵盖了从基础功能到高级特性的完整功能范围。

## 测试覆盖范围

### 1. 基础路径访问 (SimplePathAccess)
- **根路径访问** (`$`) - 测试对JSON根元素的访问
- **属性访问** (`$.property`, `$.nested.property`) - 测试对象属性的访问
- **数组索引** (`$.array[0]`, `$.array[-1]`) - 测试数组索引访问，包括负数索引
- **数组切片** (`$.array[1:3]`, `$.array[:2]`, `$.array[2:]`) - 测试数组切片操作
- **通配符** (`$.store.*`, `$.array[*]`) - 测试通配符选择

### 2. 递归查询 (RecursiveDescent)
- **属性递归** (`$..property`) - 递归查找所有匹配的属性
- **数组索引递归** (`$..[0]`) - 递归查找所有数组的第一个元素
- **复杂递归** (`$..employees[*].name`) - 复杂的递归查询组合

### 3. 过滤表达式 (Filter)
- **基础比较** (`$.array[?(@.price < 10)]`) - 数值、字符串比较
- **逻辑操作符** (`&&`, `||`) - AND、OR逻辑组合
- **存在性检查** (`$.array[?(@.property)]`) - 属性存在性验证
- **嵌套路径过滤** - 复杂嵌套结构的过滤

### 4. 内置函数 (BuiltinMethods)
- **长度函数** - 数组和字符串长度测试
- **数组函数** - max、min、size等数组操作函数

### 5. 自定义函数 (CustomMethods)
- **函数注册** - 自定义方法的注册和使用
- **链式调用** - 多个自定义方法的链式调用
- **方法注销** - 自定义方法的删除和清理

### 6. 联合操作 (Union)
- **多重选择** (`$.array[0,2]`) - 选择多个特定元素
- **复杂表达式** - 复杂联合表达式的组合

### 7. 错误处理和边界情况 (ErrorHandling & EdgeCases)
- **无效路径** - 对不存在路径的处理
- **格式错误表达式** - 语法错误表达式的处理
- **空容器** - 空数组和空对象的处理
- **特殊字符** - 包含特殊字符的键名处理
- **类型不匹配** - 类型不匹配操作的处理

### 8. 可变查询 (MutableQuery)
- **基础修改** - 通过JSONPath修改JSON值
- **数组修改** - 修改数组元素

### 9. 性能测试 (Performance)
- **大型数据集** - 1000+元素的大规模数据查询
- **深层嵌套** - 深层嵌套结构的查询性能

### 10. 复杂综合测试 (Complex)
- **多级过滤** - 复杂的多级过滤组合
- **递归与过滤结合** - 递归查询和过滤的结合使用
- **嵌套方法调用** - 复杂的嵌套自定义方法调用

### 11. 高级边界测试 (Advanced)
- **正则表达式过滤** - 正则表达式匹配测试
- **多个负数索引** - 负数索引的高级用法
- **长路径** - 非常深的路径访问
- **空值和null处理** - 各种空值情况的处理
- **Unicode支持** - Unicode字符串和特殊字符
- **数值边界** - 数值比较的边界情况
- **大型数组** - 10000+元素的超大数组测试
- **路径验证** - JSONPath表达式的有效性验证
- **对象方法测试** - JsonPath对象各种方法的测试
- **复杂联合表达式** - 高级联合操作

## 测试数据结构

测试使用了一个复杂的JSON结构，包含：
- **书店数据** - 包含书籍数组和自行车对象
- **公司数据** - 包含部门和员工的嵌套结构
- **数组数据** - 各种类型的数组（数字、混合类型等）
- **特殊字符数据** - 包含特殊字符的键名
- **深层嵌套数据** - 多层嵌套的对象结构

## 自定义函数测试

测试套件包含多个自定义函数：
- `customAverage` - 计算数组平均值
- `customContains` - 检查数组是否包含特定值
- `first` - 获取数组第一个元素
- `hasSkill` - 检查技能数组中是否包含特定技能

## 运行结果

所有106个测试用例都已通过，证明JSONPath实现的稳定性和完整性：
- **总测试数**: 106
- **通过**: 106
- **失败**: 0

## 代码结构

```cpp
// 测试分类
TEST(SimplePathAccess_*)     // 基础路径访问
TEST(RecursiveDescent_*)     // 递归查询
TEST(Filter_*)              // 过滤表达式
TEST(BuiltinMethods_*)      // 内置函数
TEST(CustomMethods_*)       // 自定义函数
TEST(Union_*)               // 联合操作
TEST(ErrorHandling_*)       // 错误处理
TEST(EdgeCases_*)           // 边界情况
TEST(MutableQuery_*)        // 可变查询
TEST(Performance_*)         // 性能测试
TEST(Complex_*)             // 复杂综合测试
TEST(Advanced_*)            // 高级边界测试
```

## 编译和运行

```bash
# 编译
cmake --build . --target test_jsonpath_comprehensive

# 运行
./Debug/test_jsonpath_comprehensive.exe
```

## 意义和价值

这个测试套件确保了JSONPath实现的：
1. **功能完整性** - 覆盖所有标准JSONPath功能
2. **稳定性** - 边界情况和错误处理
3. **性能** - 大数据集和深层嵌套的处理能力
4. **扩展性** - 自定义函数的支持
5. **兼容性** - 各种数据类型和特殊情况的支持

该测试套件为JSONPath功能的维护和进一步开发提供了可靠的质量保证。
